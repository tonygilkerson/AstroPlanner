APSF,V1,0,,-1,0,
//- Find all minor planets with orbital inclination > 75 deg in MPCORB.DAT and add to the plan

sub main()
	const inclinationLimit = 75.0
	
	// Loop through all objects in the MPCORB.DAT database
	dim n as integer = 0
	dim count as integer = APMinorPlanetObject.Count(APMinorPlanetObject.mp_MPCORB)
	Dialog.StartProgress("MPCORB Database Search",true,count)
	for i as integer = 1 to count
		if Dialog.UpdateProgress(i) then exit
		dim ob as APMinorPlanetObject = APMinorPlanetObject.Get(i,APMinorPlanetObject.mp_MPCORB)
		if ob.OrbitalInclination>inclinationLimit and ob.OrbitalInclination<=90.0 then
			// Orbital inclination greater than inclinationLimit, add to the plan
			call ob.AddToPlan
			n = n + 1
		end if
	next
	Dialog.StopProgress
	Print str(n)+" minor planets added to "+Plan().Name
end sub
