APSF,V1,0,,-1,0,
// Find object (NGC1952) in catalogues and add to plan
//= NGC1952 Lookup

sub main()
	// Create list window
	dim list as new ListWindow
	list.Heading(1) = "Object"
	list.Heading(2) = "ID"
	list.Heading(3) = "Name"
	list.Heading(4) = "Catalog"
	
	dim row as integer = 1
	// Find the object NGC1952 in the catalogues
	dim nFound as integer = APCatalog.FindID("NGC1952")
	if nFound <= 0 then
		list.Cell(row,1) = "None found"
	else
		// Add the objects found to the plan document
		for j as integer = 1 to nFound
			dim ob as APCatalogObject = APCatalog.FoundObject(j)
			list.Cell(row,1) = j
			list.Cell(row,4) = ob.Catalog
			for i as integer = 1 to 30
				dim s as string = ob.ID(i)
				if s = "" then exit
				list.Cell(row,2)=s
				list.Cell(row,3)=ob.Name
				row=row+1
			next
			call ob.AddToPlan
		next
	end if
end sub
